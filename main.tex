% !TeX spellcheck = de_DE
\documentclass[12pt,bibstyle=none,pagenumberinfooter]{ifmdocument}


%general settings
\author{José Luis Muñoz Reyes}
\title{Einarbeitung}
\date{\the\day.\the\month.\the\year}
\headerblock{%
	{\bfseries\normalsize Institut für Mechanik}\\[0.2em]
	\thetitle\\
	\theauthor, \thedate
}

%usercommands
\input{header}

\begin{document}
	\maketitle
	\section{First task}

The following tensors are given: 

\begin{gather}
  \vec{a} = \begin{bmatrix}
    3 \\ 1 \\ 2
  \end{bmatrix}, \quad
  \vec{A} = \begin{bmatrix}
    2 & 2 & 1 \\ 2 & -1 & 0 \\ 1 & 0 & 3
  \end{bmatrix} .
\end{gather}

The product $\Vec{b} = \Vec{A}\cdot \Vec{a}$ is defined as:

\begin{equation}
    b_i = \sum\limits_{i=1}^3 \sum\limits_{j=1}^3  A_{i,j} \, a_j
\end{equation}

and yields the vector

\begin{equation}
    \Vec{b} = \begin{bmatrix}
        3\cdot 2 + 2\cdot1 + 1\cdot2 \\ 2\cdot3 + (-1)\cdot1 + 0\cdot2 \\ 1\cdot3 + 0\cdot1 + 2\cdot3 
    \end{bmatrix} 
    = \begin{bmatrix}
        10 \\ 5 \\ 9
    \end{bmatrix}.
\end{equation}

The symmetric part of $\vec{A}$ is given by:

\begin{align}
    sym(\Vec{A}) 
    &   =\frac{1}{2}\,(\vec{A} + \vec{A}^{T}) \\
    &   = \frac{1}{2}\, \left(  \begin{bmatrix}
                             2 & 2 & 1 \\ 2 & -1 & 0 \\ 1 & 0 & 3
                            \end{bmatrix} +  \begin{bmatrix}
                            2 & 2 & 1 \\ 2 & -1 & 0 \\ 1 & 0 & 3 
                            \end{bmatrix}
                            \right) \\
    &   = \begin{bmatrix}
        2 & 2 & 1 \\ 2 & -1 & 0 \\ 1 & 0 & 3
        \end{bmatrix}        
\end{align}

and the anti-symmetric part of $\vec{A}$ is given by:

\begin{align}
    skw(\Vec{A}) 
    &   = \frac{1}{2}\left(\Vec{A} - \Vec{A}^T \right) \\
    &   = \frac{1}{2}\, \left(  \begin{bmatrix}
                             2 & 2 & 1 \\ 2 & -1 & 0 \\ 1 & 0 & 3
                            \end{bmatrix} -  \begin{bmatrix}
                            2 & 2 & 1 \\ 2 & -1 & 0 \\ 1 & 0 & 3 
                            \end{bmatrix}
                            \right) \\
  &   = \begin{bmatrix}
        0 & 0 & 0 \\ 0 & 0 & 0 \\ 0 & 0 & 0
        \end{bmatrix}                             
\end{align}



and hence

\begin{align}
    sym(\Vec{A}):skw(\vec{A})
    &   = Sp\left(sym(\Vec{A})^T \cdot skw(\Vec{A}) \right) \\
    &   = Sp \left(\begin{bmatrix}
        2 & 2 & 1 \\ 2 & -1 & 0 \\ 1 & 0 & 3
        \end{bmatrix} \cdot \begin{bmatrix}
        0 & 0 & 0 \\ 0 & 0 & 0 \\ 0 & 0 & 0
        \end{bmatrix} \right) \\
    &   = Sp \begin{bmatrix}
                0 & 0 & 0 \\ 0 & 0 & 0 \\ 0 & 0 & 0
            \end{bmatrix} \\
    &   = 0.
\end{align}

The divergence of the tensor $ \Vec{A}$ is given by

\begin{align}
    \Div(\Vec{A})
    &   = \Vec{A} \cdot \Vec{\nabla} \\
    &   = \begin{bmatrix}
        2 & 2 & 1 \\[2mm] 2 & -1 & 0 \\[2mm] 1 & 0 & 3
        \end{bmatrix} \cdot \begin{bmatrix}
            \frac{\partial}{\partial x_1} \\[2mm] \frac{\partial}{\partial x_2} \\[2mm]  \frac{\partial}{\partial x_3}
        \end{bmatrix} \\[2mm]
    &   = \begin{bmatrix}
        \frac{\partial}{\partial x_1}\,(2) + \frac{\partial}{\partial x_2}\, (2) + \frac{\partial 1}{\partial x_3}\, (1) \\[2mm]
        \frac{\partial}{\partial x_1}\,(2) + \frac{\partial}{\partial x_2}\, (-1) + \frac{\partial 1}{\partial x_3}\, (0) \\[2mm]
        \frac{\partial}{\partial x_1}\,(1) + \frac{\partial}{\partial x_2}\, (0) + \frac{\partial 1}{\partial x_3}\, (3) \\
    \end{bmatrix} \\[2mm]
    &   = \begin{bmatrix}
        0 \\ 0 \\ 0
        \end{bmatrix}
\end{align}
    

\section{Second Task}

\subsection{System description and derivation of the movement equations using the Newtonian formalism}
\label{sec: NewtonianDerivation}


\begin{figure}[h]
  \begin{center}
    {
        \psfragscanon
      \psfrag{1}[c][c]{$l$}
      \psfrag{2}[c][c]{$\phi$}
      \psfrag{3}[c][c]{$m$}
      \psfrag{4}[c][c]{$g$}
      \includegraphics[width=0.2\textwidth]{Figures/Zeichnung-1.eps}}
  \end{center}
  \caption{Schematic representation of the system}
  \label{fig:skizze}
\end{figure}


%\begin{figure}[tb]
%    \centering
%    \def\svgwidth{0.4\textwidth}
%    \input{Figures/zeichnung.pdf_tex}
%    \caption{Schematic representation of the system}
%    \label{fig:skizze}
%\end{figure}



The mechanical system considered here consists of a mass point of mass $m$ attached to an ideal inelastic string of length $l$, which is fixed to a rotating bearing as shown in Figure \ref{fig:skizze}.


Since the system evolves in form of circular movement at constant curvature radius, polar coordinates are used to describe the movement. A free body diagram for the mass $m$ is shown in Figure \ref{fig:free body}. The forces considered here are gravity $F_g = m\cdot g$ and the reactive tension of the string $F_r$. Under this circumstances, moment balances in both radial and tangential direction yield the movement equations:

\begin{equation}
\label{eq: radialbalance}
    m \Ddot{r} = F_r - \cos{\phi}\,F_g = 0
\end{equation}

\begin{equation}
\label{eq: tangentialbalance}
    m\, l \, \Ddot{\phi} = -m\, g \,\sin{\phi}
\end{equation}

Equation \ref{eq: radialbalance} can be simplified for small values of $\phi <<\, 1$ by using the approximation $\sin{\phi} \approx \phi $. This yields the linear movement equation:

\begin{equation}

    \Ddot{\phi} = -\frac{g}{l}\,\phi
\end{equation}





\begin{figure}[h]
  \begin{center}
    {
        \psfragscanon
      \psfrag{1}[c][c]{$\vec{F_r}$}
      \psfrag{2}[c][c]{$\vec{F_g}$}
      \psfrag{3}[c][c]{$\vec{\xi_r}$}
      \psfrag{4}[c][c]{$\vec{\xi_{\phi}}$}
      \psfrag{5}[c][c]{$\phi$}
      \includegraphics[width=0.2\textwidth]{Figures/Zeichnung2.eps}}
  \end{center}
  \caption{Free body diagram}
  \label{fig:free body}
\end{figure}

\subsection{Derivation of the movement equations using the Lagrange formalism}
\label{sec: lagrange}

In Lagrangian mechanics, the movement equations are derived from a potential called the Lagrangian $l$, which can be written as:

\begin{equation}
\label{eq: Lagrangian}
    L(\Vec{q}, \Vec{\Dot{q}}) = T(\Vec{\Dot{q}}) - V(\Vec{q}),
\end{equation}

where $T$ is the total kinetic energy and $V$ is the potential energy of the system. This function depends on the system describing variables $\Vec{q}$ and their time derivative $\Vec{\Dot{q}}$. The movement equations can then be derived from the Lagrangian equation of second kind:

\begin{equation}
\label{eq: secondKindLagrangian}
    \frac{d}{dt}\left(\frac{\partial L}{\partial \Dot{q}}\right) - \left(\frac{\partial L}{\partial q}  \right) = \Vec{0}.
\end{equation}

Using the minimal coordinate $q$ = $\phi$, the position vector $\Vec{r}$ can be written as:

\begin{equation}
    \Vec{r} = \begin{bmatrix}
        l\,sin(\phi) \\ l\, cos(\phi) 
        \end{bmatrix}
\end{equation}

Furthermore, the kinetic and potential energy are given by:

\begin{equation}
    T = \frac{1}{2}\,\Vec{\Dot{r}}^T\,m\,\Vec{\Dot{r}}
\end{equation}

and 
\begin{equation}
    V = -m\,g\,l\,cos(\phi).
\end{equation}

Hence, the Lagrangian for the mathematical pendulum is given by:
\begin{equation}
    L = \frac{1}{2}\,\Vec{\Dot{r}}^T\,m\,\Vec{\Dot{r}} + m\,g\,l\,cos(\phi)
\end{equation}

and the required derivatives for Equation \ref{eq: Lagrangian} result to:

\begin{equation}
    \left(\frac{\partial L}{\partial \Dot{q}}\right) = \frac{\partial}{\partial \Dot{\phi}} \left( \frac{1}{2}\,m\,l^2\,(sin(\phi)^2 + cos(\phi)^2)\,\Dot{\phi}^2 \right) = m\,l^2\,\Dot{\phi}
\end{equation}

\begin{equation}
\label{eq: LagFirstPart}
    \frac{d}{dt}\left(\frac{\partial L}{\partial \Dot{q}}\right) = m\,l^2\,\Ddot{\phi}
\end{equation}

and 

\begin{equation}
\label{eq: LagSecondPart}
    \left(\frac{\partial L}{\partial q}  \right) = \frac{\partial}{\partial \phi} \left(m\,g\,l\cos(\phi)\right) = -m\,g\,l\,sin(\phi).
\end{equation}

Plugging Equation \ref{eq: LagFirstPart} and \ref{eq: LagSecondPart} into Equation \ref{eq: secondKindLagrangian} yields the movement equation:

\begin{equation}
    m\,l^2\,\Ddot{\phi} + m\,g\,l\,sin(\phi) = 0,
\end{equation}

which is equivalent to Equation \ref{eq: tangentialbalance} derived in Section \ref{sec: NewtonianDerivation}.


\subsection{Analytical solution of the linear movement equation}

The linear movement equation is a ordinary differential equation (ODE) of second order. Due to the presence of constant coefficients, the following approach can be taken:

\begin{equation}
\label{eq: linear}
    \phi (t) = \exp{(\lambda \, t)}.
\end{equation}

This approach leads to the characteristic equation:

\begin{equation}
    \lambda^2 + \frac{g}{l} = 0.
\end{equation}

The solutions to this equation assuming $\frac{g}{l}>0$ are $\lambda_{1,2} = \pm i\,\sqrt{\frac{g}{l}}$. Therefore, a general solution to Equation \ref{eq: linear} is given by:

\begin{equation}
    \phi (t) = A\,\exp{\left(\,i\sqrt{\frac{g}{l}}\,t\right)} + B\, \exp{\left(-\,i\sqrt{\frac{g}{l}}\,t\right)}
\end{equation}

The starting conditions $\Dot{\phi} = 0$ and $\phi = \phi_o$ at $t_o = 0$ yield the form:

\begin{align}
    \phi(t)
    & = \frac{\phi_o}{2}\, \left(\exp{\left(\,i\sqrt{\frac{g}{l}}\,t\right)} + \exp{\left(-\,i\sqrt{\frac{g}{l}}\,t\right)} \right) \\
    & = \phi_o\,\cos{\left(\sqrt{\frac{g}{l}}\,t \right)}
\end{align}

In the following, $\phi_o = 0.0875\,rad$ is assumed. Figure \ref{fig:LinSolutions} (top) shows the course of the analytical solution as a function of time.


\subsection{Numerical solution of the linear equation of movement}

For the numerical solution, three different integration schemes were used: explicit Euler, implicit Euler and the middle point rule. First, the linear equation was expressed in the form of a first order system of PDEs by defining a vector:
\begin{equation}
    \Vec{X} = \begin{bmatrix}
        \phi \\ \Dot{\phi} 
        \end{bmatrix},
\end{equation}

which yields the equivalent representation of Equation \ref{eq: linear} in the form:

\begin{equation}
    \Vec{\Dot{X}} = \begin{bmatrix}
        0 & 1 \\ -\frac{g}{L}\ & 0 
        \end{bmatrix} \, \Vec{X}.
        \label{eq: firstOrderSysLin}
\end{equation}

Equation \ref{eq: firstOrderSysLin} is a first order equation of the form
\begin{equation}
    \Vec{\Dot{X}} = f(t,\Vec{X}),
    \label{eq: GeneralIntForm}
\end{equation}

which can be integrated by using the different standard numerical integration methods.

For the case of explicit Euler, the integration scheme is derived from a Taylor series expansion of the position and the velocity. This yields the following equations:

\begin{equation}
    \Vec{X}(t+\Delta t) = \Vec{X}(t) + [\Dot{\Vec{X}}]_t\,\Delta t + {O(\Delta t^2)},
\end{equation}

which yields a first order approximation of the tangent:

\begin{equation}
    [\Vec{\Dot{X}}]_t = \frac{\Vec{X}(t+\Delta t)-\Vec{X}(t)}{\Delta t} + O\left(\Delta t\right).
    \label{eq: EulerTanApprox}
\end{equation}

Plugging Equation \ref{eq: EulerTanApprox} into Equation \ref{eq: firstOrderSysLin}leads to the integration scheme:

\begin{equation}
    \Vec{X}(t+\Delta t) \approx \Vec{X}(t) + \begin{bmatrix}
        0 & 1 \\ -\frac{g}{L}\ & 0 
        \end{bmatrix} \, \Vec{X}(t) \, \Delta t.
\end{equation}

Contrarily, the implicit Euler method approximates the tangent by taking the values at the end of the interesting time interval. This leads to a first order approximation as well. However, the resulting equation has to be solved explicitly:

\begin{equation}
    \Vec{X}(t+\Delta t) \approx \Vec{X}(t) + \begin{bmatrix}
        0 & 1 \\ -\frac{g}{L}\ & 0 
        \end{bmatrix} \, \Vec{X}(t+\Delta t) \, \Delta t.
\end{equation}

Rearranging the equation leads to a linear equation system of the form:

\begin{equation}
    \left(\vec{I} - \begin{bmatrix}
        0 & 1 \\ -\frac{g}{L}\ & 0 
        \end{bmatrix}\,\Delta t \right)\,\Vec{X}(t+\Delta t) \approx \Vec{X}(t),
\end{equation}
which can be solved by matrix inversion.

Finally, the midpoint rule approximates the tangent by taking its value at the middle of the interesting time interval:

\begin{equation}
    \Vec{\Dot{X}} = f\left( t+\frac{\Delta t}{2}, \Vec{X}(t) + \frac{\Delta t}{2}\,f\left(t, \Vec{X}(t)\right) \right).
\end{equation}

Applying this to Equation \ref{eq: firstOrderSysLin} yields the integration scheme:

\begin{equation}
    \Vec{X}(t+\Delta t) \approx \vec{X}(t) + \begin{bmatrix}
        0 & 1 \\ -\frac{g}{L}\ & 0 
        \end{bmatrix}\,\left(\Vec{X}(t) + \begin{bmatrix}
        0 & 1 \\ -\frac{g}{L}\ & 0 
        \end{bmatrix} \Vec{X}(t)\, \frac{\Delta t}{2} \right).
\end{equation}


\begin{figure}[h]
    \centering
    \input{Figures/Figure1.tex}
    \caption{Top: analytical (ANA) solution of the linear movement equation. Bottom: Numerical solution of the linear movement equation using explicit Euler (EE), implicit Euler (EI) and the middle point rule (MP). The studied time interval was $30\,s$ at a time step of $0.01\,s$ for all integrators.}
    \label{fig:LinSolutions}
\end{figure}

Figure \ref{fig:LinSolutions} shows both the analytical and the numerical solutions of Equation \ref{eq: linear}. The initial conditions were chosen to $\phi_o = 0.0875\,rad$ and $\Dot{\phi_o}= 0$. The total simulation time was chosen to $T = 30\,s$ at a time step of $0.01\,s$. For the numerical case, the EE, EI, and MP integration schemes were compared. As the Figure shows, the angle coordinate varied periodically in time. For the analytical case, the amplitude and period of the oscillation remained unchanged within the simulated time interval. In the case of the numerical methods, the period of the oscillation was maintained. However, the amplitude increased dramatically for the EE method, decreased for the EI method and remained almost unchanged for the MP method. 

Further, the course of the total energy of the system for the different integration methods was studied. In the mathematical pendulum system, the total energy is given by the sum of the (gravitational) potential and the kinetic energy. Taking the fixing point as reference level for the potential energy, the total energy of the system can be written as:

\begin{equation}
    E(t) = E_{kin}(t) + E_{pot}(t) = \frac{1}{2}\,m\,l^2\,\Dot{\phi}(t) - m\,g\,l\,cos\left(\phi(t)\right).
    \label{eq: energy}
\end{equation}

Since this is a conservative system, total energy should be conserved in time. As Figure \ref{fig: EnergyPlot} shows, this is not the case for the EE method for which total energy increases as the simulation elapses. Contrarily, the EI method causes a decrease in energy, which correlates with the decrease in the oscillation amplitude seen in Figure \ref{fig:LinSolutions}. On the other hand, the middle-point rule remains close to the constant total energy observed for the analytical solution.

\begin{figure}[h]
    \centering
    \input{Figures/Figure2.tex}
    \caption{Course of the system´s total energy over time as a function of the integration scheme chosen. The studied time interval was $30\,s$ at a time step of $0.01\,s$ for all integrators. EE: explicit Euler. EI: implicit Euler. MP: middle-point rule. ANA: analytical solution}
    \label{fig: EnergyPlot}
\end{figure}

Finally, a convergence analysis was carried out. The analytical solution was taken as benchmark for all integration schemes and the mean squared error (MSE) was taken as a measurement of the deviation from the analytical solution. The MSE was calculated as follows:

\begin{equation}
    MSE = \sqrt{\frac{\displaystyle \sum_{t}^T \left(\phi_{K} - \phi_{ANA}\right)^2}{T}},
    \label{eq: MSE}
\end{equation}

where $t$ is the time variable and $T$ is the total simulation time. This quantity was computed at different time steps, ranging from $10^{-6} \, s$ to $5\cdot 10^{-3} \,s$. The resulting MSEs were plotted against the time step, both in logarithmic scale, in order to study the experimental order of convergence (EOC) of the integration methods. This is shown in Figure \ref{fig: ConvergencePlot}.


\begin{figure}[h]
    \centering
    \input{Figures/Figure3.tex}
    \caption{Comparison  of the experimental mean squared error as a function of the time step for the explicit Euler (EE), implicit Euler (EI) and the middle-point rule (MP). The total simulation time and the starting conditions were chosen equal for all methods.}
    \label{fig: ConvergencePlot}
\end{figure}









\end{document}